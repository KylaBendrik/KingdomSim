<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Hello World!</title>

        <script src="map.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                var months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
                var current_month = 0;
                var year = 1;
                var mouse = {
                    x: undefined,
                    y: undefined
                };
                var gridClick = {   
                    x: -1,
                    y: -1
                };
                var buildChoice = undefined;
                
                document.getElementById("date").innerHTML = (months[current_month] + ", Year " + year);

                document.getElementById("month_button").addEventListener("click", clickEvent => {
                    current_month ++;

                    if (current_month == 12){
                        current_month = 0;
                        year ++;
                    }
                    
                    document.getElementById("date").innerHTML = (months[current_month] + ", Year " + year);
                    if (current_month == 3){
                        document.getElementById("alert").innerHTML = "It's April! Make sure you seed your fields this month.";
                    } else {
                        if (current_month == 9){
                            document.getElementById("alert").innerHTML = "It's October! Make sure you harvest your fields this month.";
                        } else {
                            document.getElementById("alert").innerHTML = "";
                        }
                    }
                });

                //clicking - yes, there is probably a better spot for this
                window.addEventListener('mousedown', function(event) {
                    mouse.x = event.clientX - 175;
                    mouse.y = event.clientY;
                    gridClick.x = Math.floor(mouse.x / 64)
                    gridClick.y = Math.floor(mouse.y / 64)
                    console.log(mouse.x + ", " + mouse.y + "; " + gridClick.x + ", " + gridClick.y);

                    if (gridClick.x > -1) {
                        if (buildChoice == 'house1'){
                            console.log("trying to build house on grid" + gridClick.x + ", " + gridClick.y)
                        }
                        if (buildChoice == 'farmland'){
                            console.log("trying to build farmland on grid" + gridClick.x + ", " + gridClick.y)
                        }
                    }
                });

                document.getElementById("buildChoiceHouse1").addEventListener("click", clickEvent => {
                    console.log("clicked 'house'");
                    buildChoice = 'house1';                    
                });
                document.getElementById("buildChoiceFarmland").addEventListener("click", clickEvent => {
                    console.log("clicked 'farmland'");
                    buildChoice = 'farmland';                    
                });
                
            });

        </script>

        <style>
            html, body {
                width: 100%;
                height: 100%;
                padding: 0;
                margin: 0;
                font-size: 0;                
            }

            body {
                display: grid;
                grid-template-areas: "menu viewport";
                grid-template-columns: 150 px 1fr;
            }

            #map {
                grid-area: viewport;
            }
            #menu {
                grid-area: menu;

                padding: 0.4em;
                border: solid darkgray 2px;

                background-color: rgb(209, 209, 209);
                border-radius: 5px;

                font-size: 14pt;
            }
            #alert {
                font-size: 14pt;
                color: darkred;
            }
            #date {
                font-size: 22pt;
            }
            .menubtn {
                background-color: rgb(190, 190, 190);
                color: black;
                width: 140px;
                padding: 16px;
                font-size: 16px;
                border: none;
            }
            .dropbtn {
                background-color: rgb(190, 190, 190);
                color: black; 
                width: 140px;
                padding: 16px;
                font-size: 16px;
                border: none;
            }
            .dropdown {
                position: relative;
                display: inline-block;
            }
            .dropdown-content {
                display: none;
                position: absolute;
                background-color: #f1f1f1;
                min-width: 160px;
                box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
                z-index: 1;
            }
            .dropdown-content a {
                color: black;
                padding: 12px 16px;
                text-decoration: none;
                display: block;
            }
            .dropdown-content a:hover {background-color: #ddd;}
            .dropdown:hover .dropdown-content {display: block;}
            .dropdown:hover .dropbtn {background-color: rgb(160, 160, 160)}
            .menubtn:hover .menubtn {background-color: rgb(160, 160, 160)}
        </style>
    </head>
    <body>
        <canvas id="map"></canvas>
        <div id="menu">
            <span id="date"></span><br>
            <button class="menubtn" id="month_button" type="button">Next Month</button><br>

            <div class="dropdown">
                <button class="dropbtn">Build</button>
                <div class="dropdown-content">
                  <a href="#" id="buildChoiceHouse1">House</a>
                  <a href="#" id="buildChoiceFarmland">Farmland</a>
                </div>
            </div>

            
 
            <div id="alert"></div>
            <div id="window"></div>
        </div>
    </body>
</html>